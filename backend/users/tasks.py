from celery import shared_task
from django.conf import settings
from django.core.mail import send_mail
from celery.schedules import crontab
from backend.celery import celery_app
from user_reports import *
from organization.models import Organization
from .models import User


@shared_task(name="send_completed_tasks_mail")
def send_completed_tasks_mail():
    get_completed_tasks()

@shared_task(name="send_active_tasks_mail_1")
def send_active_tasks_mail():
    get_active_tasks([3, 71, 121, 199, 200, 202, 205, 207, 208, 209, 210, 216, 217, 218, 220, 221, 224, 231, 238, 245, 257, 262, 263, 265, 270, 274, 275, 277, 278, 279, 285, 454, 572, 573, 596, 677, 678, 683, 685, 688, 705, 706, 707, 708, 709, 710, 711, 714, 715, 717, 718, 719, 724, 725, 743, 746, 747, 847, 850, 853, 896, 897, 905, 909, 912, 1075, 1078, 1089, 1103, 1104, 1105, 1141, 1165, 1179, 1187, 1201, 1206, 1226, 1235, 1257, 1260, 1269, 1279, 1282, 1301, 1303, 1305, 1307, 1314, 1324, 1330, 1352, 1353, 1358, 1366, 1385, 1390, 64])
    
@shared_task(name="send_active_tasks_mail_2")
def send_active_tasks_mail():
    get_active_tasks([1400, 1414, 1416, 1419, 1420, 1422, 1426, 1427, 1433, 1434, 1435, 1439, 1446, 1451, 1453, 1457, 1460, 1461, 1463, 1469, 1473, 1482, 1483, 1484, 1486, 1487, 1492, 1496, 1497, 1498, 1511, 1513, 1514, 1515, 1524, 1525, 1526, 1528, 1529, 1531, 1532, 1541, 1542, 1544, 1554, 1558, 1563, 1564, 1573, 1574, 1585, 1592, 1593, 1594, 1597, 1599, 1602, 1603, 1604, 1611, 1612, 1617, 1623, 1625, 1627, 1633, 1638, 1639, 1652, 1653, 1654, 1655, 1658, 1660, 1662, 1664, 1666, 1668, 1669, 1672, 1680, 1689, 1690, 1693, 1695, 1696, 1697, 1698, 1700, 1702, 1703, 1707, 1714, 1716, 1717, 1721, 1722, 1724, 64])

@shared_task(name="send_active_tasks_mail_3")
def send_active_tasks_mail():
    get_active_tasks([1725, 1726, 1731, 1734, 1738, 1739, 1742, 1743, 1745, 1747, 1748, 1752, 1753, 1754, 1756, 1758, 1759, 1761, 1763, 1764, 1765, 1766, 1769, 1770, 1771, 1773, 1774, 1777, 1778, 1785, 1786, 1788, 1795, 1807, 1809, 1810, 1812, 1817, 1818, 1820, 1823, 1826, 1827, 1835, 1837, 1842, 1844, 1845, 1848, 1849, 1851, 1853, 1854, 1855, 1856, 1859, 1861, 1864, 1866, 1873, 1874, 1878, 1879, 1881, 1882, 1884, 1885, 1886, 1887, 1888, 1891, 1892, 1893, 1894, 1895, 1898, 1900, 1901, 1906, 1907, 1910, 1911, 1912, 1913, 1914, 1918, 1920, 1921, 1923, 1924, 1925, 1926, 1929, 1930, 1931, 1933, 1934, 1935, 64])

@shared_task(name="send_active_tasks_mail_4")
def send_active_tasks_mail():
    get_active_tasks([1939, 1942, 1943, 1944, 1945, 1947, 1952, 1955, 1957, 1958, 1959, 1960, 1963, 1967, 1968, 1971, 1973, 1984, 1985, 1986, 1987, 2005, 2007, 2011, 2015, 2018, 2023, 2028, 2030, 2035, 2040, 2043, 2044, 2046, 2047, 2048, 2049, 2050, 2053, 2054, 2057, 2059, 2063, 2065, 2066, 2071, 2075, 2080, 2082, 2087, 2089, 2090, 2092, 2096, 2098, 2099, 2101, 2102, 2104, 2105, 2106, 2109, 2112, 2113, 2115, 2135, 2136, 2142, 2143, 2144, 2157, 2159, 2160, 2170, 2172, 2173, 2177, 2178, 2190, 2193, 2195, 2198, 2200, 2204, 2206, 2210, 2220, 2221, 2224, 2231, 2232, 2236, 2239, 2241, 2242, 2243, 2244, 2247, 64])

@shared_task(name="send_active_tasks_mail_5")
def send_active_tasks_mail():
    get_active_tasks([2248, 2252, 2253, 2254, 2255, 2256, 2257, 2259, 2263, 2264, 2266, 2268, 2273, 2278, 2281, 2282, 2283, 2286, 2289, 2291, 2293, 2296, 2299, 2300, 2320, 2322, 2326, 2328, 2329, 2336, 2337, 2338, 2339, 2340, 2343, 2344, 2345, 2351, 2353, 2360, 2361, 2365, 2374, 2376, 2379, 2390, 2395, 2402, 2405, 2459, 2461, 2471, 2472, 2480, 2485, 2486, 2487, 2550, 2559, 64])

@shared_task(name="send_new_tasks_mail")
def send_new_tasks_mail():
    get_new_tasks()


@shared_task(name="send_new_users_to_org_owner")
def send_new_users_to_org_owner():
    get_new_users()


@shared_task(name="send_eta_reminders")
def send_eta_reminders():
    get_eta_reminders()
